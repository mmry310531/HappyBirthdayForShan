<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>æ²‰æµ¸å¼å°èªª â€” ç”Ÿæ—¥é©šå–œ</title>
<style>
  :root{ --bg:#071029; --glass: rgba(255,255,255,0.04); --accent:#ff7aa2; }
  html,body{height:100%;margin:0;font-family: 'Noto Sans TC', system-ui, -apple-system;background:radial-gradient(ellipse at 10% 10%, #071029 0%, #071029 35%, #020311 100%); color:#e9f2ff}
  .container{max-width:1200px;margin:0 auto;padding:28px;display:flex;height:100vh;align-items:center;justify-content:center}
  .stage{width:100%;max-width:1000px;height:720px;border-radius:16px;position:relative;overflow:hidden;box-shadow:0 12px 40px rgba(2,6,23,0.6);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));}
  .bg{position:absolute;inset:0;background-size:cover;background-position:center;transition:background-image 800ms ease-in-out, filter 600ms linear;filter:brightness(0.86) saturate(1.05) blur(0.2px)}
  .vignette{position:absolute;inset:0;background:linear-gradient(180deg, rgba(2,6,23,0.25), rgba(2,6,23,0.6));pointer-events:none}
  .textPanel{position:absolute;left:40px;right:40px;bottom:36px;background:var(--glass);backdrop-filter: blur(8px);border-radius:12px;padding:22px;color:#f6fbff}
  .titleRow{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
  .sceneTitle{font-weight:700;font-size:18px}
  .time{font-size:14px;color:rgba(255,255,255,0.75)}
  #line{font-size:20px;line-height:1.9;min-height:160px}
  .controls{display:flex;gap:10px;align-items:center;margin-top:14px}
  button{padding:10px 14px;border-radius:10px;border:none;cursor:pointer;background:var(--accent);color:#fff;font-weight:600}
  button.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:rgba(255,255,255,0.9)}
  .choices{position:absolute;left:40px;bottom:220px;display:flex;flex-direction:column;gap:10px}
  .choiceBtn{background:rgba(255,255,255,0.04);border-radius:10px;padding:12px 16px;border:none;color:#f6fbff;cursor:pointer}
  .hidden{display:none}
  .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6)}
  .modalBox{background:#071028;padding:22px;border-radius:12px;color:#fff;max-width:720px}
  .sr-only{position:absolute;left:-9999px}
</style>
</head>
<body>
<div class="container">
  <main class="stage" id="stage">
    <div id="bg" class="bg"></div>
    <div class="vignette"></div>
    <div class="choices" id="choices" aria-hidden="true"></div>
    <section class="textPanel" id="textPanel" role="region" aria-live="polite">
      <div class="titleRow">
        <div class="sceneTitle" id="sceneTitle">æ­£åœ¨è¼‰å…¥...</div>
        <div class="time">å‰©é¤˜ï¼š<span id="time">05:00</span></div>
      </div>
      <div id="line">è«‹ç¨å€™ï¼Œæ•…äº‹è¼‰å…¥ä¸­ã€‚</div>
      <div class="controls">
        <button id="nextBtn">ä¸‹ä¸€æ­¥</button>
        <button id="autoBtn" class="secondary">è‡ªå‹•æ’­æ”¾</button>
        <button id="skipBtn" class="secondary">å¿«è½‰</button>
      </div>
    </section>
  </main>
</div>
<div id="modalRoot" class="hidden"></div>

<script>
// ========== CONFIG ==========
const BGM_SRC = ''; // å¦‚æœæœ‰éŸ³æ¨‚ï¼ŒæŠŠç¶²å€å¡«é€™è£¡ï¼Œå¦å‰‡ç•™ç©º
const DEFAULT_BG = '';
const AUTO_LINE_DELAY = 2500;
const TOTAL_SECONDS = 5*60;

// ========== state ==========
let story = {
  scenes:[
    {
      title:'å¤œçš„å¼•å°è€…',
      bg:'',
      lines:[
        'å¤œè‰²åƒä¸€å¼µæŸ”è»Ÿçš„å¸ƒï¼Œè¼•è¼•è“‹åœ¨åŸå¸‚ä¸Šã€‚',
        'ä¸€å°æ²’æœ‰ç½²åçš„ä¿¡å‡ºç¾åœ¨ä½ æ•é‚Šï¼Œè£¡é¢åªå¯«äº†å¹¾å€‹å­—ï¼šè·Ÿæˆ‘ä¾†ã€‚'
      ]
    },
    {
      title:'ç¢¼é ­',
      bg:'',
      lines:[
        'æ½®æ±ä½è½ï¼Œéœ²å‡ºäº†æ¿•å†·çš„æœ¨æ¿ã€‚',
        'é æ–¹çš„ç‡ˆå¡”é–ƒçˆï¼Œåƒæ˜¯ç­‰å¾…è‘—ä½ çš„å›æ‡‰ã€‚'
      ],
      choices:[{text:'èµ°å‘ç‡ˆå¡”', goto:2},{text:'ååœ¨ç¢¼é ­', goto:3}]
    },
    {
      title:'ç‡ˆå¡”',
      bg:'',
      lines:[
        'ç‡ˆå¡”è£¡æœ‰ä¸€å¼µå°ç´™æ¢ï¼Œæ‘ºæˆé£›æ©Ÿçš„æ¨£å­ã€‚',
        'ä¸Šé¢å¯«è‘—ï¼šç”Ÿæ—¥å¿«æ¨‚ â€” é€™æ˜¯æˆ‘ç‚ºä½ æº–å‚™çš„å°ç¦®ã€‚'
      ],
      reveal:true,
      gift:'ç”Ÿæ—¥å¿«æ¨‚ï¼é€™ä»½ç¦®ç‰©æ˜¯ï¼šä¸€å¼µæ‰‹å·¥æ˜ä¿¡ç‰‡å’Œä½ æœ€å–œæ­¡çš„æ›²å­ã€‚'
    },
    {
      title:'ååœ¨ç¢¼é ­',
      bg:'',
      lines:[
        'ä½ ååœ¨æ½®æ¿•çš„ç¢¼é ­ä¸Šï¼Œçœ‹è‘—æµ·æµªè¼•æ‹ã€‚',
        'å¾®é¢¨å¸¶ä¾†é¹¹é¹¹çš„æ°£æ¯ï¼Œå¤œè‰²æŸ”å’Œã€‚'
      ]
    }
  ]
};
let currentScene=0,currentLine=0,autoPlaying=false,totalSeconds=TOTAL_SECONDS,timerInterval=null,audio=null;

// ========== elements ==========
const sceneTitleEl = document.getElementById('sceneTitle');
const timeEl = document.getElementById('time');
const lineEl = document.getElementById('line');
const bgEl = document.getElementById('bg');
const choicesEl = document.getElementById('choices');
const nextBtn = document.getElementById('nextBtn');
const autoBtn = document.getElementById('autoBtn');
const skipBtn = document.getElementById('skipBtn');
const modalRoot = document.getElementById('modalRoot');

// ========== helpers ==========
function formatTime(sec){return `${String(Math.floor(sec/60)).padStart(2,'0')}:${String(sec%60).padStart(2,'0')}`;}
function startTimer(){clearInterval(timerInterval);totalSeconds=TOTAL_SECONDS;timeEl.textContent=formatTime(totalSeconds);
timerInterval=setInterval(()=>{totalSeconds--;timeEl.textContent=formatTime(totalSeconds);if(totalSeconds<=0){clearInterval(timerInterval);endStory();}},1000);}
function endStory(){lineEl.textContent='æ•…äº‹çµæŸ â€” å¸Œæœ›ä½ å–œæ­¡é€™ä»½å°ç¦®ç‰©ã€‚';stopAudio();}
function playAudio(src){if(!src) return; try{audio=new Audio(src);audio.loop=true;audio.volume=0.6;audio.play().catch(()=>{});}catch(e){console.warn(e)}}
function stopAudio(){if(audio){audio.pause();audio=null;}}

function setBackground(url){if(!url){bgEl.style.backgroundImage=''; return;} const img=new Image(); img.src=url; img.onload=()=>{bgEl.style.backgroundImage=`url(${url})`;};}

function renderChoices(scene){
  choicesEl.innerHTML='';
  if(scene.choices && scene.choices.length){
    choicesEl.setAttribute('aria-hidden','false');
    scene.choices.forEach(c=>{
      const btn=document.createElement('button');
      btn.className='choiceBtn';
      btn.textContent=c.text;
      btn.onclick=()=>{currentScene=c.goto;currentLine=0;renderCurrent();};
      choicesEl.appendChild(btn);
    });
  } else {choicesEl.setAttribute('aria-hidden','true');}
}

function showReveal(msg){
  modalRoot.innerHTML='';
  const modal=document.createElement('div'); modal.className='modal';
  const box=document.createElement('div'); box.className='modalBox';
  box.innerHTML=`<h3>é©šå–œ ğŸ</h3><div style="margin-top:10px">${msg}</div><div style="margin-top:14px"><button id='closeReveal'>é—œé–‰</button></div>`;
  modal.appendChild(box); modalRoot.appendChild(modal); modalRoot.classList.remove('hidden');
  document.getElementById('closeReveal').onclick=()=>{modalRoot.innerHTML='';modalRoot.classList.add('hidden');};
}

function renderCurrent(){
  const s=story.scenes[currentScene]; if(!s) return endStory();
  sceneTitleEl.textContent=s.title || `ç« ç¯€ ${currentScene+1}`;
  setBackground(s.bg||'');
  currentLine=Math.min(currentLine,(s.lines||[]).length-1);
  lineEl.textContent=s.lines ? s.lines[currentLine] : '';
  renderChoices(s);
  if(s.reveal) showReveal(s.gift || '');
}

function step(){const s=story.scenes[currentScene]; if(!s) return endStory();
if(currentLine<(s.lines||[]).length-1){currentLine++; lineEl.textContent=s.lines[currentLine];}
else{if(s.choices&&s.choices.length){} else if(currentScene<story.scenes.length-1){currentScene++;currentLine=0;renderCurrent();}else endStory();}}

function autoFlow(){if(!autoPlaying) return; step(); setTimeout(()=>{if(autoPlaying) autoFlow();},AUTO_LINE_DELAY);}

// ========== UI events ==========
nextBtn.onclick=()=>{step();};
autoBtn.onclick=()=>{autoPlaying=!autoPlaying; autoBtn.textContent=autoPlaying?'åœæ­¢è‡ªå‹•':'è‡ªå‹•æ’­æ”¾'; if(autoPlaying) autoFlow();};
skipBtn.onclick=()=>{for(let i=0;i<4;i++) step();};

// ========== initialization ==========
(function init(){currentScene=0;currentLine=0;renderCurrent();startTimer();if(BGM_SRC) playAudio(BGM_SRC);})();
</script>
</body>
</html>
